---
id: t_ai_global_report
title: –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ AI –ø–æ –º–æ–±–∏–ª—å–Ω—ã–º –ø–æ–¥–ø–∏—Å–∫–∞–º –∏ –ø–ª–∞—Ç–µ–∂–∞–º
short_description: "‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –≠—Ç–æ –¢–ê–ë–õ–ò–¶–ê ClickHouse, –ù–ï –¥–∞—à–±–æ—Ä–¥! –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –≥–ª–æ–±–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∞—è –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞: –ø–æ–¥–ø–∏—Å–∫–∏, –ø–ª–∞—Ç–µ–∂–∏, –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –µ–¥–∏–Ω–∏—Ü—ã –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ, –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã, –Ω–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ MAF —Å —Ä–∞–∑–±–∏–≤–∫–æ–π –ø–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º –∏ –≥–æ—Ä–æ–¥–∞–º."
type: table
tags:
  - "#KnowledgeBase"
  - "#AI_Report"
---

# ¬´–ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ AI –ø–æ –º–æ–±–∏–ª—å–Ω—ã–º –ø–æ–¥–ø–∏—Å–∫–∞–º –∏ –ø–ª–∞—Ç–µ–∂–∞–º¬ª ‚Äî t_ai_global_report

## –ù–∞–∑–≤–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã
**–ö–æ—Ä–æ—Ç–∫–æ–µ –∏–º—è (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ):** –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ AI –ø–æ –º–æ–±–∏–ª—å–Ω—ã–º –ø–æ–¥–ø–∏—Å–∫–∞–º –∏ –ø–ª–∞—Ç–µ–∂–∞–º  
**–¢–µ—Ö. –∏–º—è:** `t_ai_global_report`

### ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –≠—Ç–æ –¢–ê–ë–õ–ò–¶–ê, –ù–ï –î–ê–®–ë–û–†–î**
**t_ai_global_report - —ç—Ç–æ –¢–ê–ë–õ–ò–¶–ê ClickHouse –¥–ª—è SQL-–∑–∞–ø—Ä–æ—Å–æ–≤, –ù–ï –¥–∞—à–±–æ—Ä–¥!** –ö —ç—Ç–æ–π —Ç–∞–±–ª–∏—Ü–µ –º–æ–∂–Ω–æ –∏ –Ω—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å SQL-–∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

## –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
**t_ai_global_report - —ç—Ç–æ –¢–ê–ë–õ–ò–¶–ê ClickHouse, –ù–ï –¥–∞—à–±–æ—Ä–¥!** –¢–∞–±–ª–∏—Ü–∞ `t_ai_global_report` —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π –¥–ª—è AI-–∞–Ω–∞–ª–∏–∑–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞. –û–Ω–∞ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –ø–æ–¥–ø–∏—Å–∫–∞–º, –ø–ª–∞—Ç–µ–∂–∞–º, –∞–∫—Ç–∏–≤–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º, –µ–¥–∏–Ω–∏—Ü–∞–º –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ, –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∞–∫–∫–∞—É–Ω—Ç–∞–º, –Ω–æ–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏ MAF (Monthly Active Flats) —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º –∏ –≥–æ—Ä–æ–¥–∞–º. –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ —Å—Ä–µ–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏—Ö —Ä–µ—à–µ–Ω–∏–π –∏ –≥–ª—É–±–æ–∫–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏.

### ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –û–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**
**–¢–∞–±–ª–∏—Ü–∞ –£–ñ–ï —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–±–æ–≥–∞—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ!** –ü–æ–ª—è `company_name`, `country`, `region` —É–∂–µ –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞–ø—Ä—è–º—É—é –≤ —Ç–∞–±–ª–∏—Ü–µ –∏ –ù–ï —Ç—Ä–µ–±—É—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö JOIN –∫ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞–º. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–∏ –ø–æ–ª—è –Ω–∞–ø—Ä—è–º—É—é –≤ SELECT –±–µ–∑ –æ–±–æ–≥–∞—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ `companies_dir_partner_ch` –∏–ª–∏ –¥—Ä—É–≥–∏–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏.

### ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏**
**–ü–†–ê–í–ò–õ–û –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ:** –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï —É–∫–∞–∑–∞–ª –¥–∞—Ç—É –≤ –∑–∞–ø—Ä–æ—Å–µ, –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ—Å–ª–µ–¥–Ω—é—é –¥–æ—Å—Ç—É–ø–Ω—É—é –¥–∞—Ç—É –∏–∑ —Ç–∞–±–ª–∏—Ü—ã: `WHERE report_date = (SELECT max(report_date) FROM t_ai_global_report WHERE total_active_users > 0)`

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**

### üì± **–ü–æ–¥–ø–∏—Å–∫–∏ –∏ –∫–æ–º–º–µ—Ä—Ü–∏—è:**
- **Android –ø–æ–¥–ø–∏—Å–∫–∏:** –Ω–æ–≤—ã–µ, –ø—Ä–æ–¥–ª–µ–Ω–Ω—ã–µ, —Å –∫–∞—Ä—Ç—ã, —á–µ—Ä–µ–∑ YooKassa
- **iOS –ø–æ–¥–ø–∏—Å–∫–∏:** —á–µ—Ä–µ–∑ App Store, —Å –∫–∞—Ä—Ç—ã, –ø–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏
- **–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏:** –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏, PRO –ø–æ–¥–ø–∏—Å–∫–∏, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏
- **–û—à–∏–±–∫–∏ –∏ –æ—Ç–º–µ–Ω—ã:** –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø—Ä–æ–¥–ª–µ–Ω–∏—è, –æ—Ç–º–µ–Ω—ã –ø–æ–¥–ø–∏—Å–æ–∫ –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º
- **28-–¥–Ω–µ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:** –Ω–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –ø—Ä–æ–¥–ª–µ–Ω–∏—è, –æ—Ç–º–µ–Ω—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 28 –¥–Ω–µ–π

### üí∞ **–ü–ª–∞—Ç–µ–∂–∏ –∏ –¥–æ—Ö–æ–¥—ã:**
- **–î–Ω–µ–≤–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏:** –ø—Ä–∏–±—ã–ª—å –æ—Ç Android/iOS, –ø–æ–∫—É–ø–∫–∏ –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º (1‚ÇΩ, 35‚ÇΩ, 69‚ÇΩ, 85‚ÇΩ, 249‚ÇΩ, 499‚ÇΩ, 2390‚ÇΩ)
- **–ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏:** –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
- **–í–æ–∑–≤—Ä–∞—Ç—ã:** —Å—É–º–º—ã –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º –∏ —Ç–∞—Ä–∏—Ñ–∞–º
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞:** App Store vs YooKassa, Android vs iOS

### üë• **–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:**
- **–û–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:** –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ –¥–µ–Ω—å
- **–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è:** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π, —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π
- **BLE —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º Bluetooth Low Energy
- **–ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:** –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ

### üè¢ **–ï–¥–∏–Ω–∏—Ü—ã –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ:**
- **–°–≤–æ–±–æ–¥–Ω–∞—è –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è:** –µ–¥–∏–Ω–∏—Ü—ã —Å–æ —Å–≤–æ–±–æ–¥–Ω–æ–π –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π, PRO –ø–æ–¥–ø–∏—Å–∫–∏
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è:** –µ–¥–∏–Ω–∏—Ü—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π
- **–û–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:** –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ

### üéØ **–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã:**
- **–û–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:** –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ:** —Å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π, —Å BLE, —Å BLE –∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π
- **–ù–æ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã:** —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞ –¥–µ–Ω—å/–º–µ—Å—è—Ü

### üè† **MAF (Monthly Active Flats):**
- **–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã:** —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∑–∞ –¥–µ–Ω—å
- **–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è –∫–≤–∞—Ä—Ç–∏—Ä:** —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π/—Å–≤–æ–±–æ–¥–Ω–æ–π –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π

<!-- ### üîë **–õ–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω—ã–µ –∫–ª—é—á–∏ (–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã):**
- **–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏:** –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π
- **–ü–æ–¥–ø–∏—Å—á–∏–∫–∏ —Å –∫–ª—é—á–∞–º–∏:** –≤–µ—Ä–Ω—É–≤—à–∏–µ—Å—è –∏ –Ω–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏ —Å –∫–ª—é—á–∞–º–∏
- **–û—Ç–º–µ–Ω—ã:** –æ—Ç–º–µ–Ω–∏–≤—à–∏–µ –ø–æ–¥–ø–∏—Å–∫—É (–≤–µ—Ä–Ω—É–≤—à–∏–µ—Å—è –∏ –Ω–æ–≤—ã–µ)

### üìç **–£—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏ (–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã):**
- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫:** –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- **–û–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å:** —Ç–æ—á–∫–∏ —Å –¥–æ–º–æ—Ñ–æ–Ω–æ–º –æ–Ω–ª–∞–π–Ω, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–º–æ—Ñ–æ–Ω–æ–≤ –æ–Ω–ª–∞–π–Ω
- **–î–æ–º–æ—Ñ–æ–Ω—ã:** –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–º–æ—Ñ–æ–Ω–æ–≤
-->

### üè¢ **–†–µ–∫–≤–∏–∑–∏—Ç—ã –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤:**
- **–ò–ù–ù:** –Ω–∞–ª–æ–≥–æ–≤—ã–π –Ω–æ–º–µ—Ä –ø–∞—Ä—Ç–Ω–µ—Ä–∞
- **–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç:** –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ª–∏—á–Ω–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞ –ø–∞—Ä—Ç–Ω–µ—Ä–∞

## –•—Ä–∞–Ω–∏–ª–∏—â–µ –∏ –¥–≤–∏–∂–æ–∫
- –ë–î: `db1`  
- –¢–∞–±–ª–∏—Ü–∞: `t_ai_global_report`  
- –î–≤–∏–∂–æ–∫: `MergeTree`  
- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: `ORDER BY report_date`
- –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ: `t_ai_global_report_mv` (–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 06:05)

## DDL
```sql
CREATE MATERIALIZED VIEW db1.t_ai_global_report_mv
    REFRESH EVERY 1 DAY OFFSET 6 HOUR 5 MINUTE TO db1.t_ai_global_report AS
    WITH t_dec AS(
        SELECT
            t1.report_date  AS report_date,
            t2.city_uuid  AS city_uuid,
            t2.partner_uuid  AS partner_uuid
        FROM
            (SELECT DISTINCT report_date FROM db1.installation_point_st_partner_ch) AS t1
        CROSS JOIN
            (SELECT DISTINCT city_uuid, inst.partner_uuid AS partner_uuid
            FROM db1.installation_point_st_partner_ch AS inst
            LEFT JOIN db1.entries_installation_points_dir_partner_ch AS eipdp 
                ON inst.installation_point_id = eipdp.installation_point_id) AS t2
        )
    SELECT
        t_dec.report_date AS report_date,
        t_dec.partner_uuid AS partner_uuid,
        t_dec.city_uuid AS city_uuid,
        eipdp.city AS city,
        eipdp.country AS country,
        eipdp.region AS region,
        cdp.company_name AS company_name,
        cdp.partner_lk AS partner_lk,
        -- –í—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –∏–∑ –æ–±—ä–µ–¥–∏–Ω—è–µ–º—ã—Ö —Ç–∞–±–ª–∏—Ü
    FROM t_dec
    LEFT JOIN db1.units_on_sk_platform_rep_mobile_total AS uosprmt 
        ON uosprmt.report_date = t_dec.report_date 
        AND uosprmt.city_uuid = t_dec.city_uuid
        AND uosprmt.partner_uuid = t_dec.partner_uuid
    -- –î—Ä—É–≥–∏–µ JOIN'—ã —Å –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
    ORDER BY report_date DESC;
```

## –ü–æ–ª—è –∏ –∞–ª–∏–∞—Å—ã

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è
**–í–ù–ò–ú–ê–ù–ò–ï: –ü–æ–ª—è `company_name`, `country`, `region` —É–∂–µ –æ–±–æ–≥–∞—â–µ–Ω—ã –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞–ø—Ä—è–º—É—é - –ù–ï —Ç—Ä–µ–±—É—é—Ç JOIN!**

| –ü–æ–ª–µ                          | –¢–∏–ø     | –ê–ª–∏–∞—Å (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ)                  |
| ----------------------------- | ------- | ----------------------------------------- |
| `report_date`                 | Date    | –î–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö                               |
| `partner_uuid`                | String  | UUID –ø–∞—Ä—Ç–Ω–µ—Ä–∞                             |
| `city_uuid`                   | String  | UUID –≥–æ—Ä–æ–¥–∞                               |
| `city`                        | String  | –ì–æ—Ä–æ–¥                                     |
| `country`                     | String  | –°—Ç—Ä–∞–Ω–∞                                    |
| `region`                      | String  | –†–µ–≥–∏–æ–Ω                                    |
| `company_name`                | String  | –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏                          |
| `partner_lk`                  | String  | –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –ø–∞—Ä—Ç–Ω—ë—Ä–∞                   |

### –ú–µ—Ç—Ä–∏–∫–∏ –ø–æ–¥–ø–∏—Å–æ–∫
**–í–ù–ò–ú–ê–ù–ò–ï: –í—Å–µ –ø–æ–ª—è —Å–æ–¥–µ—Ä–∂–∞—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫, –∞ –Ω–µ —Å—É–º–º—ã –æ–ø–ª–∞—Ç!**

| –ü–æ–ª–µ                          | –¢–∏–ø     | –ê–ª–∏–∞—Å (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ)                  |
| ----------------------------- | ------- | ----------------------------------------- |
| `android_sub`                 | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫ Android (—Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ)         |
| `android_sub_extended_new`    | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–ª–µ–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ Android (—Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ) |
| `android_sub_extended_new_cart` | UInt64 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–ª–µ–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ Android —Å –∫–∞—Ä—Ç—ã      |
| `android_sub_first_new`      | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ Android (—Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ)    |
| `android_sub_first_new_cart` | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ Android —Å –∫–∞—Ä—Ç—ã            |
| `android_sub_from_cart`       | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫ Android —Å –∫–∞—Ä—Ç—ã                  |
| `ios_sub`                    | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫ iOS —á–µ—Ä–µ–∑ App Store              |
| `ios_sub_extended_new`       | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–ª–µ–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ iOS —á–µ—Ä–µ–∑ App Store   |
| `ios_sub_extended_new_cart`  | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–ª–µ–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ iOS —Å –∫–∞—Ä—Ç—ã           |
| `ios_sub_first_new`          | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ iOS —á–µ—Ä–µ–∑ App Store        |
| `ios_sub_first_new_cart`     | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ iOS —Å –∫–∞—Ä—Ç—ã                |
| `ios_sub_first_new_cart_transition` | UInt64 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫ iOS —Å –∫–∞—Ä—Ç—ã (–ø–µ—Ä–µ—Ö–æ–¥ –∏–∑ App Store) |
| `ios_sub_from_cart`          | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫ iOS —Å –∫–∞—Ä—Ç—ã                      |
| `paying_users`               | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫               |
| `paying_users_day`           | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫, –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ –¥–µ–Ω—å –¥–∞–Ω–Ω—ã—Ö    |
| `paying_users_partner_pro`   | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ PRO –ø–æ–¥–ø–∏—Å–æ–∫ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤                    |
| `paying_users_standart`      | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫                      |
| `paying_users_standart_appstore` | UInt64 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫ iOS —á–µ—Ä–µ–∑ App Store             |
| `paying_users_standart_ios_from_cart` | UInt64 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫ iOS —Å –∫–∞—Ä—Ç—ã (–ø–µ—Ä–µ—Ö–æ–¥ —Å App Store) |
| `paying_users_standart_yakassa` | UInt64 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫ Android —á–µ—Ä–µ–∑ YooKassa (—Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ) |

### –ú–µ—Ç—Ä–∏–∫–∏ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
| –ü–æ–ª–µ                          | –¢–∏–ø     | –ê–ª–∏–∞—Å (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ)                  |
| ----------------------------- | ------- | ----------------------------------------- |
| `failed_subscript_last_28_days` | UInt64 | –û—à–∏–±–∫–∏ –æ–ø–ª–∞—Ç—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 28 –¥–Ω–µ–π        |
| `renew_failed_at`            | UInt64  | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø—Ä–æ–¥–ª–µ–Ω–∏–π/–æ–ø–ª–∞—Ç |
| `renew_failed_at_month`     | UInt64  | –ù–µ—É–¥–∞—á–Ω—ã–µ –ø—Ä–æ–¥–ª–µ–Ω–∏—è/–æ–ø–ª–∞—Ç—ã –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ (–∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ) |
| `renew_failed_at_andeoid_cart` | UInt64 | –ù–µ—É–¥–∞—á–Ω—ã–µ –ø—Ä–æ–¥–ª–µ–Ω–∏—è Android —Å –∫–∞—Ä—Ç—ã       |
| `renew_failed_at_android`   | UInt64  | –ù–µ—É–¥–∞—á–Ω—ã–µ –ø—Ä–æ–¥–ª–µ–Ω–∏—è Android (—Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ) |
| `renew_failed_at_ios`       | UInt64  | –ù–µ—É–¥–∞—á–Ω—ã–µ –ø—Ä–æ–¥–ª–µ–Ω–∏—è iOS —á–µ—Ä–µ–∑ App Store   |
| `renew_failed_at_ios_cart`  | UInt64  | –ù–µ—É–¥–∞—á–Ω—ã–µ –ø—Ä–æ–¥–ª–µ–Ω–∏—è iOS —Å –∫–∞—Ä—Ç—ã           |
| `renew_stopped_at`           | UInt64  | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–º–µ–Ω–µ–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫      |
| `renew_stopped_at_month`    | UInt64  | –û—Ç–º–µ–Ω—ã –ø–æ–¥–ø–∏—Å–æ–∫ –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ (–∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ) |
| `renew_stopped_at_android`  | UInt64  | –û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ Android (—Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ) |
| `renew_stopped_at_android_cart` | UInt64 | –û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ Android —Å –∫–∞—Ä—Ç—ã       |
| `renew_stopped_at_ios`      | UInt64  | –û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ iOS —á–µ—Ä–µ–∑ App Store   |
| `renew_stopped_at_ios_cart` | UInt64  | –û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ iOS —Å –∫–∞—Ä—Ç—ã           |
| `renewed_subscriptions_last_28_days` | UInt64 | –ü—Ä–æ–¥–ª–µ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 28 –¥–Ω–µ–π |
| `stoped_subscript_last_28_days` | UInt64 | –û—Ç–º–µ–Ω—ã –ø–æ–¥–ø–∏—Å–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 28 –¥–Ω–µ–π      |

### –ú–µ—Ç—Ä–∏–∫–∏ –µ–¥–∏–Ω–∏—Ü –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
| –ü–æ–ª–µ                          | –¢–∏–ø     | –ê–ª–∏–∞—Å (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ)                  |
| ----------------------------- | ------- | ----------------------------------------- |
| `units_free_monetization_start` | UInt64 | –ï–¥–∏–Ω–∏—Ü—ã —Å–æ —Å—Ç–∞—Ä—Ç–æ–≤–æ–π PRO –ø–æ–¥–ø–∏—Å–∫–æ–π (PRO –±–µ–∑ enterprise) |
| `units_free_monetization`    | UInt64  | –ï–¥–∏–Ω–∏—Ü—ã —Å–æ —Å–≤–æ–±–æ–¥–Ω–æ–π –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π         |
| `units_free_monetization_pro` | UInt64 | –ï–¥–∏–Ω–∏—Ü—ã —Å–æ —Å–≤–æ–±–æ–¥–Ω–æ–π –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π PRO     |
| `units_on_platform`          | UInt64  | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ     |
| `units_stricted monetization` | UInt64 | –ï–¥–∏–Ω–∏—Ü—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π       |

### –ú–µ—Ç—Ä–∏–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
| –ü–æ–ª–µ                          | –¢–∏–ø     | –ê–ª–∏–∞—Å (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ)                  |
| ----------------------------- | ------- | ----------------------------------------- |
| `total_active_user_monetization_per_day` | UInt64 | –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π –∑–∞ –¥–µ–Ω—å |
| `total_active_user_subscribed_monetization_per_day` | UInt64 | –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π –∑–∞ –¥–µ–Ω—å |
| `total_active_users_per_day` | UInt64  | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ –¥–µ–Ω—å |
| `new_active_users`           | UInt64  | –ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω—ã –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ) |
| `total_active_user_subscribed_monetization` | UInt64 | –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π |
| `total_active_users`         | UInt64  | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  |
| `total_active_users_ble_available` | UInt64 | –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º BLE     |
| `total_active_users_ble_available_monetization` | UInt64 | –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å BLE –∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π |
| `total_active_users_ble_available_subscribed_monetization` | UInt64 | –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å BLE, –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π –∏ –ø–æ–¥–ø–∏—Å–∫–æ–π |
| `total_active_users_monetization` | UInt64 | –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π      |

### –ú–µ—Ç—Ä–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π (–¥–Ω–µ–≤–Ω—ã–µ)
| –ü–æ–ª–µ                          | –¢–∏–ø     | –ê–ª–∏–∞—Å (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ)                  |
| ----------------------------- | ------- | ----------------------------------------- |
| `Android_PL`                 | Float64 | –ü—Ä–∏–±—ã–ª—å –æ—Ç Android –∑–∞ –¥–µ–Ω—å                |
| `IOS_PL`                     | Float64 | –ü—Ä–∏–±—ã–ª—å –æ—Ç iOS –∑–∞ –¥–µ–Ω—å                     |
| `appstore_count_1`           | UInt64  | –ü–æ–∫—É–ø–∫–∏ –∑–∞ 1‚ÇΩ –≤ App Store –∑–∞ –¥–µ–Ω—å         |
| `appstore_count_1_refunded`  | UInt64  | –í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 1‚ÇΩ –≤ App Store –∑–∞ –¥–µ–Ω—å        |
| `appstore_count_2390`        | UInt64  | –ü–æ–∫—É–ø–∫–∏ –∑–∞ 2390‚ÇΩ –≤ App Store –∑–∞ –¥–µ–Ω—å      |
| `appstore_count_2390_refunded` | UInt64 | –í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 2390‚ÇΩ –≤ App Store –∑–∞ –¥–µ–Ω—å     |
| `appstore_count_499`         | UInt64  | –ü–æ–∫—É–ø–∫–∏ –∑–∞ 499‚ÇΩ –≤ App Store –∑–∞ –¥–µ–Ω—å       |
| `appstore_count_499_refunded` | UInt64 | –í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 499‚ÇΩ –≤ App Store –∑–∞ –¥–µ–Ω—å      |
| `appstore_count_69`          | UInt64  | –ü–æ–∫—É–ø–∫–∏ –∑–∞ 69‚ÇΩ –≤ App Store –∑–∞ –¥–µ–Ω—å        |
| `appstore_count_69_refunded` | UInt64  | –í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 69‚ÇΩ –≤ App Store –∑–∞ –¥–µ–Ω—å       |
| `appstore_count_85`          | UInt64  | –ü–æ–∫—É–ø–∫–∏ –∑–∞ 85‚ÇΩ –≤ App Store –∑–∞ –¥–µ–Ω—å        |
| `appstore_count_85_refunded` | UInt64  | –í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 85‚ÇΩ –≤ App Store –∑–∞ –¥–µ–Ω—å       |
| `yookassa_count_1`           | UInt64  | –ü–æ–∫—É–ø–∫–∏ –∑–∞ 1‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å      |
| `yookassa_count_1_refunded`  | UInt64  | –í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 1‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å     |
| `yookassa_count_2390`        | UInt64  | –ü–æ–∫—É–ø–∫–∏ –∑–∞ 2390‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å  |
| `yookassa_count_2390_refunded` | UInt64 | –í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 2390‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å |
| `yookassa_count_249`         | UInt64  | –ü–æ–∫—É–ø–∫–∏ –∑–∞ 249‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å    |
| `yookassa_count_249_refunded` | UInt64 | –í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 249‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å  |
| `yookassa_count_35`          | UInt64  | –ü–æ–∫—É–ø–∫–∏ –∑–∞ 35‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å     |
| `yookassa_count_35_refunded` | UInt64  | –í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 35‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å   |
| `yookassa_count_499`         | UInt64  | –ü–æ–∫—É–ø–∫–∏ –∑–∞ 499‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å    |
| `yookassa_count_499_refunded` | UInt64 | –í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 499‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å  |
| `yookassa_count_69`          | UInt64  | –ü–æ–∫—É–ø–∫–∏ –∑–∞ 69‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å    |
| `yookassa_count_69_refunded` | UInt64 | –í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 69‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å   |
| `yookassa_count_85`          | UInt64  | –ü–æ–∫—É–ø–∫–∏ –∑–∞ 85‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å    |
| `yookassa_count_85_refunded` | UInt64  | –í–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 85‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å   |
| `refunded_amount_appstore`   | Float64 | –°—É–º–º–∞ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ –≤ App Store –∑–∞ –¥–µ–Ω—å       |
| `refunded_amount_yookassa`   | Float64 | –°—É–º–º–∞ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –¥–µ–Ω—å    |

### –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π (–º–µ—Å—è—á–Ω—ã–µ)
| –ü–æ–ª–µ                          | –¢–∏–ø     | –ê–ª–∏–∞—Å (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ)                  |
| ----------------------------- | ------- | ----------------------------------------- |
| `Android_PL_cum`             | Float64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –ø—Ä–∏–±—ã–ª—å Android –∑–∞ –º–µ—Å—è—Ü     |
| `IOS_PL_cum`                 | Float64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –ø—Ä–∏–±—ã–ª—å iOS –∑–∞ –º–µ—Å—è—Ü         |
| `appstore_count_1_cum`       | UInt64  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 1‚ÇΩ –≤ App Store –∑–∞ –º–µ—Å—è—Ü |
| `appstore_count_1_refunded_cum` | UInt64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 1‚ÇΩ –≤ App Store –∑–∞ –º–µ—Å—è—Ü |
| `appstore_count_2390_cum`     | UInt64  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 2390‚ÇΩ –≤ App Store –∑–∞ –º–µ—Å—è—Ü |
| `appstore_count_2390_refunded_cum` | UInt64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 2390‚ÇΩ –≤ App Store –∑–∞ –º–µ—Å—è—Ü |
| `appstore_count_499_cum`      | UInt64  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 499‚ÇΩ –≤ App Store –∑–∞ –º–µ—Å—è—Ü |
| `appstore_count_499_refunded_cum` | UInt64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 499‚ÇΩ –≤ App Store –∑–∞ –º–µ—Å—è—Ü |
| `appstore_count_69_cum`       | UInt64  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 69‚ÇΩ –≤ App Store –∑–∞ –º–µ—Å—è—Ü |
| `appstore_count_69_refunded_cum` | UInt64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 69‚ÇΩ –≤ App Store –∑–∞ –º–µ—Å—è—Ü |
| `appstore_count_85_cum`       | UInt64  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 85‚ÇΩ –≤ App Store –∑–∞ –º–µ—Å—è—Ü |
| `appstore_count_85_refunded_cum` | UInt64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 85‚ÇΩ –≤ App Store –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_1_cum`        | UInt64  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 1‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_1_refunded_cum` | UInt64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 1‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_2390_cum`     | UInt64  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 2390‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_2390_refunded_cum` | UInt64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 2390‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_249_cum`      | UInt64  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 249‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_249_refunded_cum` | UInt64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 249‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_35_cum`       | UInt64  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 35‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_35_refunded_cum` | UInt64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 35‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_499_cum`      | UInt64  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 499‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_499_refunded_cum` | UInt64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 499‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_69_cum`       | UInt64  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 69‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_69_refunded_cum` | UInt64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 69‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_85_cum`       | UInt64  | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫—É–ø–∫–∏ –∑–∞ 85‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `yookassa_count_85_refunded_cum` | UInt64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—Ç—ã –∑–∞ 85‚ÇΩ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |
| `refunded_amount_appstore_cum` | Float64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è —Å—É–º–º–∞ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ –≤ App Store –∑–∞ –º–µ—Å—è—Ü |
| `refunded_amount_yookassa_cum` | Float64 | –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è —Å—É–º–º–∞ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ —á–µ—Ä–µ–∑ YooKassa –∑–∞ –º–µ—Å—è—Ü |

### –ú–µ—Ç—Ä–∏–∫–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
| –ü–æ–ª–µ                          | –¢–∏–ø     | –ê–ª–∏–∞—Å (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ)                  |
| ----------------------------- | ------- | ----------------------------------------- |
| `total_activated_account`     | UInt64  | –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ |
| `total_activated_account_monetization` | UInt64 | –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã —Å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π |
| `total_activated_account_ble_available_monetization` | UInt64 | –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã —Å BLE –∏ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π |
| `total_activated_account_ble_available` | UInt64 | –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã —Å –¥–æ—Å—Ç—É–ø–Ω—ã–º BLE |
| `new_created_account`         | UInt64  | –ö–£–ú–£–õ–Ø–¢–ò–í–ù–û–ï –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∑–∞ –º–µ—Å—è—Ü |
| `new_activated_account`       | UInt64  | –ö–£–ú–£–õ–Ø–¢–ò–í–ù–û–ï –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–æ–≤—ã—Ö –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∑–∞ –º–µ—Å—è—Ü |
| `new_created_account_day`     | UInt64  | –ù–æ–≤—ã–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã –∑–∞ –¥–µ–Ω—å          |
| `new_activated_account_day`   | UInt64  | –ù–æ–≤—ã–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã –∑–∞ –¥–µ–Ω—å     |

### –ú–µ—Ç—Ä–∏–∫–∏ MAF (Monthly Active Flats)
| –ü–æ–ª–µ                          | –¢–∏–ø     | –ê–ª–∏–∞—Å (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ)                  |
| ----------------------------- | ------- | ----------------------------------------- |
| `MAF`                         | UInt64  | –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–≤–∞—Ä—Ç–∏—Ä—ã —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∑–∞ –¥–µ–Ω—å |
| `stricted_MAF`               | UInt64  | –ö–≤–∞—Ä—Ç–∏—Ä—ã —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π      |
| `freemonetization_MAF`       | UInt64  | –ö–≤–∞—Ä—Ç–∏—Ä—ã —Å–æ —Å–≤–æ–±–æ–¥–Ω–æ–π –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π        |

<!-- ### –ú–µ—Ç—Ä–∏–∫–∏ –ª–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π (–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã)
| –ü–æ–ª–µ                          | –¢–∏–ø     | –ê–ª–∏–∞—Å (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ)                  |
| ----------------------------- | ------- | ----------------------------------------- |
| `activated_keys`              | UInt32  | –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª—é—á–∏                      |
| `activated_sub_w_key`         | UInt32  | –í–µ—Ä–Ω—É–≤—à–∏–µ—Å—è –ø–æ–¥–ø–∏—Å—á–∏–∫–∏ —Å –∫–ª—é—á–æ–º           |
| `created_first_sub_w_key`     | UInt32  | –ù–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏ —Å –∫–ª—é—á–æ–º                 |
| `d_activated_sub_w_key`       | UInt32  | –û—Ç–º–µ–Ω–∏–≤—à–∏–µ –ø–æ–¥–ø–∏—Å–∫—É (–≤–µ—Ä–Ω—É–≤—à–∏–µ—Å—è)         |
| `d_created_first_sub_w_key`  | UInt32  | –û—Ç–º–µ–Ω–∏–≤—à–∏–µ –ø–æ–¥–ø–∏—Å–∫—É (–Ω–æ–≤—ã–µ)               |

### –ú–µ—Ç—Ä–∏–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ (–≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã)
| –ü–æ–ª–µ                          | –¢–∏–ø     | –ê–ª–∏–∞—Å (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ)                  |
| ----------------------------- | ------- | ----------------------------------------- |
| `countd_inst_by_c_and_p`     | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏                |
| `countd_inter_par_by_c_and_p` | UInt64  | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ—á–µ–∫ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å –¥–æ–º–æ—Ñ–æ–Ω–æ–º –æ–Ω–ª–∞–π–Ω |
| `countd_inst_par_onl_by_c_and_p` | UInt64 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–º–æ—Ñ–æ–Ω–æ–≤                      |
| `countd_inter_par_onl_by_c_and_p` | UInt64 | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–º–æ—Ñ–æ–Ω–æ–≤ –æ–Ω–ª–∞–π–Ω               |
-->

### –†–µ–∫–≤–∏–∑–∏—Ç—ã –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
| –ü–æ–ª–µ                          | –¢–∏–ø     | –ê–ª–∏–∞—Å (—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ)                  |
| ----------------------------- | ------- | ----------------------------------------- |
| `tin`                         | String  | –ò–ù–ù                                       |

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è –∫ –ø–æ–ª—è–º

### –¢–∏–ø—ã –º–µ—Ç—Ä–∏–∫
- **–î–Ω–µ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** ‚Äî –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–µ–Ω—å
- **–ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** ‚Äî –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü (–ø–æ–º–µ—á–µ–Ω—ã `_cum` –∏–ª–∏ "–∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ")
- **28-–¥–Ω–µ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** ‚Äî –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 28 –¥–Ω–µ–π


### –ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 06:05 —á–µ—Ä–µ–∑ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π `WHERE report_date < today() - 2`
- **–†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å:** –ø–∞—Ä—Ç–Ω–µ—Ä √ó –≥–æ—Ä–æ–¥ √ó –¥–∞—Ç–∞ (–¥–µ–∫–∞—Ä—Ç–æ–≤–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π)
- **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:** –ø–æ –¥–∞—Ç–µ –¥–∞–Ω–Ω—ã—Ö (DESC) –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ—Å–ª–µ–¥–Ω–∏–º –¥–∞–Ω–Ω—ã–º
- **–°–≤—è–∑–∏:** —Å —Ç–∞–±–ª–∏—Ü–∞–º–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤, —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞–º–∏ –≥–æ—Ä–æ–¥–æ–≤
- **AI-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è AI-–∞–Ω–∞–ª–∏–∑–∞ –∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
- **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ:** –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã —á–µ—Ä–µ–∑ INSERT –∑–∞–ø—Ä–æ—Å—ã
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö:** –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 –¥–Ω—è
- **–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ—Å—Ç—å:** –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ 10+ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ –µ–¥–∏–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É (–ª–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω—ã–µ –∫–ª—é—á–∏ –∏ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã)

## –ß–∞—Å—Ç—ã–µ —Å—Ä–µ–∑—ã/—Ñ–∏–ª—å—Ç—Ä—ã

### üìÖ **–í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–∑—ã:**
- **–ü–æ –¥–∞—Ç–µ (`report_date`):** —á–∞—â–µ –≤—Å–µ–≥–æ –ø–æ—Å–ª–µ–¥–Ω—è—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –¥–∞—Ç–∞
- **–ü–æ –ø–µ—Ä–∏–æ–¥—É:** –¥–∏–∞–ø–∞–∑–æ–Ω—ã –¥–∞—Ç –¥–ª—è —Ç—Ä–µ–Ω–¥–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞
- **–ü–æ –º–µ—Å—è—Ü–∞–º:** –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
- **28-–¥–Ω–µ–≤–Ω—ã–µ –æ–∫–Ω–∞:** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–µ–¥–∞–≤–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### üè¢ **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å—Ä–µ–∑—ã:**
- **–ü–æ –ø–∞—Ä—Ç–Ω–µ—Ä—É (`partner_uuid`):** –∞–Ω–∞–ª–∏–∑ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–∞—Ä—Ç–Ω–µ—Ä—É
- **–ü–æ –≥–æ—Ä–æ–¥—É (`city`, `city_uuid`):** —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- **–ü–æ –ª–∏—á–Ω–æ–º—É –∫–∞–±–∏–Ω–µ—Ç—É (`partner_lk`):** –∞–Ω–∞–ª–∏–∑ –ø–æ –õ–ö –ø–∞—Ä—Ç–Ω–µ—Ä–∞
- **–ü–æ –ò–ù–ù (`tin`):** –∞–Ω–∞–ª–∏–∑ –ø–æ –Ω–∞–ª–æ–≥–æ–≤–æ–º—É –Ω–æ–º–µ—Ä—É

### üì± **–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–∑—ã:**
- **Android vs iOS:** —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º
- **App Store vs YooKassa:** –∞–Ω–∞–ª–∏–∑ –ø–ª–∞—Ç–µ–∂–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
- **–ö–∞—Ä—Ç—ã vs –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏:** –∞–Ω–∞–ª–∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã

### üí∞ **–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Å—Ä–µ–∑—ã:**
- **–ü–æ —Ç–∞—Ä–∏—Ñ–∞–º:** –∞–Ω–∞–ª–∏–∑ –ø–æ —Ü–µ–Ω–æ–≤—ã–º —Å–µ–≥–º–µ–Ω—Ç–∞–º (1‚ÇΩ, 35‚ÇΩ, 69‚ÇΩ, 85‚ÇΩ, 249‚ÇΩ, 499‚ÇΩ, 2390‚ÇΩ)
- **–ü–æ –¥–æ—Ö–æ–¥–∞–º:** –¥–Ω–µ–≤–Ω—ã–µ vs –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- **–ü–æ –≤–æ–∑–≤—Ä–∞—Ç–∞–º:** –∞–Ω–∞–ª–∏–∑ –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º –∏ —Ç–∞—Ä–∏—Ñ–∞–º

### üë• **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ä–µ–∑—ã:**
- **–ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:** –æ–±—â–∏–µ, —Å –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–µ–π, —Å BLE
- **–ù–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:** —Å–æ–∑–¥–∞–Ω–Ω—ã–µ vs –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
- **–ü–æ–¥–ø–∏—Å—á–∏–∫–∏:** —Å –∫–ª—é—á–∞–º–∏, –±–µ–∑ –∫–ª—é—á–µ–π, –ø–æ —Ç–∏–ø–∞–º –ø–æ–¥–ø–∏—Å–æ–∫

### üè† **–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Å—Ä–µ–∑—ã:**
- **MAF –º–µ—Ç—Ä–∏–∫–∏:** –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–≤–∞—Ä—Ç–∏—Ä
- **–£—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏:** –∞–Ω–∞–ª–∏–∑ –ø–æ —Ç–æ—á–∫–∞–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏
- **–î–æ–º–æ—Ñ–æ–Ω—ã:** –æ–Ω–ª–∞–π–Ω —Å—Ç–∞—Ç—É—Å, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–º–æ—Ñ–æ–Ω–æ–≤

### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ¬´–ø–æ—Å–ª–µ–¥–Ω–µ–π –¥–∞—Ç—ã¬ª
–ü–æ—Å–ª–µ–¥–Ω—è—è –¥–∞—Ç–∞ ‚Äî —ç—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è `report_date`, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ª–æ–≤–∏–µ:  
`sum(paying_users) > 0` –∏–ª–∏ `sum(total_active_users) > 0`

### ‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û - –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏**

**–ü–†–ê–í–ò–õ–û –ü–û –£–ú–û–õ–ß–ê–ù–ò–Æ:** –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï —É–∫–∞–∑–∞–ª –¥–∞—Ç—É –≤ –∑–∞–ø—Ä–æ—Å–µ, –í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ—Å–ª–µ–¥–Ω—é—é –¥–æ—Å—Ç—É–ø–Ω—É—é –¥–∞—Ç—É –∏–∑ —Ç–∞–±–ª–∏—Ü—ã.

**–õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã:**
- ‚úÖ **–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∫–∞–∑–∞–ª –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –¥–∞—Ç—É** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –µ—ë: `WHERE report_date = '2025-08-31'`
- ‚úÖ **–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∫–∞–∑–∞–ª –ø–µ—Ä–∏–æ–¥** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –¥–∏–∞–ø–∞–∑–æ–Ω: `WHERE report_date BETWEEN '2025-08-01' AND '2025-08-31'`
- ‚úÖ **–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï —É–∫–∞–∑–∞–ª –¥–∞—Ç—É** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π –ø–æ—Å–ª–µ–¥–Ω—é—é –¥–æ—Å—Ç—É–ø–Ω—É—é: `WHERE report_date = (SELECT max(report_date) FROM t_ai_global_report WHERE total_active_users > 0)`

**–ó–∞–ø—Ä–µ—â–µ–Ω–æ:** –ª—é–±—ã–µ CTE —Å –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏ (`WITH ... AS (SELECT max(...) ...)`) ‚Äî –æ–Ω–∏ –≤—ã–∑—ã–≤–∞—é—Ç ILLEGAL_AGGREGATION –≤ ClickHouse.

## –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ (ClickHouse)

1) **–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π**
```sql
SELECT
  report_date,
  sum(total_active_users) AS active_users,
  sum(paying_users) AS paying_users,
  sum(Android_PL + IOS_PL) AS total_revenue,
  sum(units_on_platform) AS total_units,
  sum(MAF) AS total_maf
FROM t_ai_global_report
WHERE report_date >= today() - 30
  AND total_active_users > 0
GROUP BY report_date
ORDER BY report_date;
```

2) **AI-–∞–Ω–∞–ª–∏–∑ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ –ø–æ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º**
```sql
WITH last_date AS (
  SELECT max(report_date) AS report_date
  FROM t_ai_global_report
  WHERE total_active_users > 0
)
SELECT
  partner_uuid,
  partner_lk,
  sum(total_active_users) AS total_users,
  sum(paying_users) AS paying_users,
  sum(paying_users) / nullIf(sum(total_active_users), 0) AS conversion_rate,
  sum(Android_PL + IOS_PL) AS revenue,
  sum(units_on_platform) AS units,
  sum(MAF) AS maf
FROM t_ai_global_report
INNER JOIN last_date USING (report_date)
GROUP BY partner_uuid, partner_lk
HAVING total_users > 0
ORDER BY conversion_rate DESC
LIMIT 20;
```

3) **–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å AI-–º–µ—Ç—Ä–∏–∫–∞–º–∏**
```sql
WITH last_date AS (
  SELECT max(report_date) AS report_date
  FROM t_ai_global_report
  WHERE total_active_users > 0
)
SELECT
  city,
  sum(total_active_users) AS active_users,
  sum(paying_users) AS paying_users,
  sum(Android_PL + IOS_PL) AS revenue,
  sum(units_on_platform) AS units,
  sum(MAF) AS maf,
  sum(new_created_account_day) AS new_accounts,
  sum(new_activated_account_day) AS new_activated
FROM t_ai_global_report
INNER JOIN last_date USING (report_date)
GROUP BY city
ORDER BY active_users DESC
LIMIT 15;
```

4) **AI-–∞–Ω–∞–ª–∏–∑ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π**
```sql
SELECT
  'Android' AS platform,
  sum(android_sub + android_sub_from_cart) AS subscriptions,
  sum(Android_PL) AS revenue,
  sum(yookassa_count_1 + yookassa_count_35 + yookassa_count_69 + yookassa_count_85 + yookassa_count_249 + yookassa_count_499 + yookassa_count_2390) AS purchases
FROM t_ai_global_report
WHERE report_date >= toStartOfMonth(today())
  AND paying_users > 0

UNION ALL

SELECT
  'iOS' AS platform,
  sum(ios_sub + ios_sub_from_cart) AS subscriptions,
  sum(IOS_PL) AS revenue,
  sum(appstore_count_1 + appstore_count_69 + appstore_count_85 + appstore_count_499 + appstore_count_2390) AS purchases
FROM t_ai_global_report
WHERE report_date >= toStartOfMonth(today())
  AND paying_users > 0;
```

5) **AI-–∞–Ω–∞–ª–∏–∑ —Ä–æ—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**
```sql
WITH last_date AS (
  SELECT max(report_date) AS report_date
  FROM t_ai_global_report
  WHERE total_active_users > 0
)
SELECT
  sum(total_active_users) AS current_active_users,
  sum(new_active_users) AS new_users_this_month,
  sum(new_created_account_day) AS new_accounts_today,
  sum(new_activated_account_day) AS new_activated_today,
  sum(total_activated_account) AS total_activated_accounts,
  sum(total_activated_account_monetization) AS monetized_accounts
FROM t_ai_global_report
INNER JOIN last_date USING (report_date);
```

6) **–ê–Ω–∞–ª–∏–∑ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã—Ö —Ç–æ—á–µ–∫ –∏ –¥–æ–º–æ—Ñ–æ–Ω–æ–≤ –ø–æ –≥–æ—Ä–æ–¥–∞–º –∏ –ø–∞—Ä—Ç–Ω–µ—Ä–∞–º**
```sql
WITH last_date AS (
  SELECT max(report_date) AS report_date
  FROM t_ai_global_report
  WHERE total_active_users > 0
)
SELECT
  city,
  partner_lk,
  sum(countd_inst_by_c_and_p) AS total_installation_points,
  sum(countd_inter_par_by_c_and_p) AS points_with_online_intercoms,
  sum(countd_inst_par_onl_by_c_and_p) AS total_intercoms,
  sum(countd_inter_par_onl_by_c_and_p) AS online_intercoms,
  sum(countd_inter_par_onl_by_c_and_p) / nullIf(sum(countd_inst_par_onl_by_c_and_p), 0) AS intercom_online_rate
FROM t_ai_global_report
INNER JOIN last_date USING (report_date)
GROUP BY city, partner_lk
ORDER BY total_installation_points DESC
LIMIT 20;
```

7) **–ê–Ω–∞–ª–∏–∑ –ª–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π –∏ –ø–æ–¥–ø–∏—Å–æ–∫**
```sql
WITH last_date AS (
  SELECT max(report_date) AS report_date
  FROM t_ai_global_report
  WHERE total_active_users > 0
)
SELECT
  city,
  partner_lk,
  sum(activated_keys) AS total_activated_keys,
  sum(activated_sub_w_key) AS returning_subscribers_with_key,
  sum(created_first_sub_w_key) AS new_subscribers_with_key,
  sum(d_activated_sub_w_key) AS cancelled_returning_subscribers,
  sum(d_created_first_sub_w_key) AS cancelled_new_subscribers,
  sum(activated_sub_w_key + created_first_sub_w_key) / nullIf(sum(activated_keys), 0) AS key_to_subscription_conversion
FROM t_ai_global_report
INNER JOIN last_date USING (report_date)
GROUP BY city, partner_lk
HAVING total_activated_keys > 0
ORDER BY key_to_subscription_conversion DESC
LIMIT 15;
```

8) **–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤**
```sql
WITH last_date AS (
  SELECT max(report_date) AS report_date
  FROM t_ai_global_report
  WHERE total_active_users > 0
)
SELECT
  partner_lk,
  city,
  sum(total_active_users) AS active_users,
  sum(paying_users) AS paying_users,
  sum(Android_PL + IOS_PL) AS revenue,
  sum(countd_inst_by_c_and_p) AS installation_points,
  sum(countd_inter_par_onl_by_c_and_p) AS online_intercoms,
  sum(activated_keys) AS activated_keys,
  sum(activated_sub_w_key + created_first_sub_w_key) AS subscribers_with_keys,
  sum(paying_users) / nullIf(sum(total_active_users), 0) AS user_conversion,
  sum(Android_PL + IOS_PL) / nullIf(sum(paying_users), 0) AS revenue_per_paying_user,
  sum(countd_inter_par_onl_by_c_and_p) / nullIf(sum(countd_inst_par_onl_by_c_and_p), 0) AS intercom_online_rate
FROM t_ai_global_report
INNER JOIN last_date USING (report_date)
GROUP BY partner_lk, city
HAVING active_users > 0
ORDER BY revenue DESC
LIMIT 25;
```

9) **–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º –∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º**
```sql
WITH last_date AS (
  SELECT max(report_date) AS report_date
  FROM t_ai_global_report
  WHERE total_active_users > 0
)
SELECT
  city,
  partner_lk,
  -- iOS App Store –º–µ—Ç—Ä–∏–∫–∏
  sum(appstore_count_1) AS appstore_1_rub,
  sum(appstore_count_35) AS appstore_35_rub,
  sum(appstore_count_69) AS appstore_69_rub,
  sum(appstore_count_85) AS appstore_85_rub,
  sum(appstore_count_249) AS appstore_249_rub,
  sum(appstore_count_499) AS appstore_499_rub,
  sum(appstore_count_2390) AS appstore_2390_rub,
  sum(IOS_PL) AS ios_total_revenue,
  -- Android YooKassa –º–µ—Ç—Ä–∏–∫–∏
  sum(yookassa_count_1) AS yookassa_1_rub,
  sum(yookassa_count_35) AS yookassa_35_rub,
  sum(yookassa_count_69) AS yookassa_69_rub,
  sum(yookassa_count_85) AS yookassa_85_rub,
  sum(yookassa_count_249) AS yookassa_249_rub,
  sum(yookassa_count_499) AS yookassa_499_rub,
  sum(yookassa_count_2390) AS yookassa_2390_rub,
  sum(Android_PL) AS android_total_revenue,
  -- –í–æ–∑–≤—Ä–∞—Ç—ã
  sum(refunded_amount_appstore) AS appstore_refunds,
  sum(refunded_amount_yookassa) AS yookassa_refunds
FROM t_ai_global_report
INNER JOIN last_date USING (report_date)
GROUP BY city, partner_lk
ORDER BY (ios_total_revenue + android_total_revenue) DESC
LIMIT 20;
```

10) **–ê–Ω–∞–ª–∏–∑ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ —Ç–∞—Ä–∏—Ñ–æ–≤ –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º**
```sql
WITH last_date AS (
  SELECT max(report_date) AS report_date
  FROM t_ai_global_report
  WHERE total_active_users > 0
)
SELECT
  'iOS App Store' AS platform,
  sum(appstore_count_1) AS tariff_1_rub,
  sum(appstore_count_35) AS tariff_35_rub,
  sum(appstore_count_69) AS tariff_69_rub,
  sum(appstore_count_85) AS tariff_85_rub,
  sum(appstore_count_249) AS tariff_249_rub,
  sum(appstore_count_499) AS tariff_499_rub,
  sum(appstore_count_2390) AS tariff_2390_rub,
  sum(IOS_PL) AS total_revenue
FROM t_ai_global_report
INNER JOIN last_date USING (report_date)

UNION ALL

SELECT
  'Android YooKassa' AS platform,
  sum(yookassa_count_1) AS tariff_1_rub,
  sum(yookassa_count_35) AS tariff_35_rub,
  sum(yookassa_count_69) AS tariff_69_rub,
  sum(yookassa_count_85) AS tariff_85_rub,
  sum(yookassa_count_249) AS tariff_249_rub,
  sum(yookassa_count_499) AS tariff_499_rub,
  sum(yookassa_count_2390) AS tariff_2390_rub,
  sum(Android_PL) AS total_revenue
FROM t_ai_global_report
INNER JOIN last_date USING (report_date)
ORDER BY total_revenue DESC;
```

11) **–ú–µ—Å—è—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–æ—Ö–æ–¥–æ–≤ —Å –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º**
```sql
WITH month_bounds AS (
  SELECT toStartOfMonth(today()) AS m_start, 
         addMonths(toStartOfMonth(today()), 1) AS m_end
)
SELECT
  partner_lk,
  city,
  sum(IOS_PL) AS ios_monthly_revenue,
  sum(Android_PL) AS android_monthly_revenue,
  sum(IOS_PL + Android_PL) AS total_monthly_revenue,
  -- –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º iOS
  sum(appstore_count_1 * 1) AS ios_1_rub_total,
  sum(appstore_count_35 * 35) AS ios_35_rub_total,
  sum(appstore_count_69 * 69) AS ios_69_rub_total,
  sum(appstore_count_85 * 85) AS ios_85_rub_total,
  sum(appstore_count_249 * 249) AS ios_249_rub_total,
  sum(appstore_count_499 * 499) AS ios_499_rub_total,
  sum(appstore_count_2390 * 2390) AS ios_2390_rub_total,
  -- –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ç–∞—Ä–∏—Ñ–∞–º Android
  sum(yookassa_count_1 * 1) AS android_1_rub_total,
  sum(yookassa_count_35 * 35) AS android_35_rub_total,
  sum(yookassa_count_69 * 69) AS android_69_rub_total,
  sum(yookassa_count_85 * 85) AS android_85_rub_total,
  sum(yookassa_count_249 * 249) AS android_249_rub_total,
  sum(yookassa_count_499 * 499) AS android_499_rub_total,
  sum(yookassa_count_2390 * 2390) AS android_2390_rub_total,
  -- –í–æ–∑–≤—Ä–∞—Ç—ã
  sum(refunded_amount_appstore) AS total_appstore_refunds,
  sum(refunded_amount_yookassa) AS total_yookassa_refunds
FROM t_ai_global_report
CROSS JOIN month_bounds
WHERE report_date >= m_start AND report_date < m_end
GROUP BY partner_lk, city
ORDER BY total_monthly_revenue DESC
LIMIT 15;
```

## –ö–ª—é—á–∏ –∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- **–û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª—é—á–∏:** `partner_uuid`, `city_uuid`, `report_date`
- **–í–æ–∑–º–æ–∂–Ω—ã–µ —Å–≤—è–∑–∏:** 
  - –ö —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫—É –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤ ‚Äî –ø–æ `partner_uuid`
  - –ö —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–º —Ç–æ—á–∫–∞–º ‚Äî —á–µ—Ä–µ–∑ `installation_point_st_partner_ch`
  - –ö –∞–¥—Ä–µ—Å–Ω—ã–º –¥–∞–Ω–Ω—ã–º ‚Äî —á–µ—Ä–µ–∑ `entries_installation_points_dir_partner_ch`

## –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è

### ‚è∞ **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:** –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 06:05, –≤–æ–∑–º–æ–∂–Ω—ã –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–æ 1-2 —á–∞—Å–æ–≤
- **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:** –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 2 –¥–Ω—è –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏
- **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ:** –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã

### üìä **–¢–∏–ø—ã –º–µ—Ç—Ä–∏–∫:**
- **–î–Ω–µ–≤–Ω—ã–µ vs –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ:** —á–µ—Ç–∫–æ —Ä–∞–∑–ª–∏—á–∞–π—Ç–µ –¥–Ω–µ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –æ—Ç –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã—Ö (–ø–æ–º–µ—á–µ–Ω—ã `_cum`)
- **28-–¥–Ω–µ–≤–Ω—ã–µ –æ–∫–Ω–∞:** –º–µ—Ç—Ä–∏–∫–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 28 –¥–Ω–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –Ω–µ–¥–∞–≤–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- **–ú–µ—Å—è—á–Ω—ã–µ –∞–≥—Ä–µ–≥–∞—Ç—ã:** –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ –∑–∞ —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü

### üî¢ **–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
- **–ù—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:** –º–Ω–æ–≥–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å NULL –∏–ª–∏ 0, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `nullIf()` –≤ —Ä–∞—Å—á–µ—Ç–∞—Ö
- **–î–µ–∫–∞—Ä—Ç–æ–≤–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ:** —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø–∞—Ä—Ç–Ω–µ—Ä √ó –≥–æ—Ä–æ–¥ √ó –¥–∞—Ç–∞
- **LEFT JOIN:** –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω—ã —á–µ—Ä–µ–∑ LEFT JOIN –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π

### üì± **–ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **Android vs iOS:** –º–µ—Ç—Ä–∏–∫–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω—ã –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º, —É—á–∏—Ç—ã–≤–∞–π—Ç–µ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ
- **App Store vs YooKassa:** —Ä–∞–∑–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∞—Ä–∏—Ñ–∞–º–∏
- **–ö–∞—Ä—Ç—ã vs –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏:** —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã –ø–æ–¥–ø–∏—Å–æ–∫

### üí∞ **–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **–¢–∞—Ä–∏—Ñ—ã:** —Ü–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã –≤ —Ä—É–±–ª—è—Ö, —É—á–∏—Ç—ã–≤–∞–π—Ç–µ –∏–Ω—Ñ–ª—è—Ü–∏—é –ø—Ä–∏ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ
- **–í–æ–∑–≤—Ä–∞—Ç—ã:** –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–æ–≤ –ø–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º –∏ —Ç–∞—Ä–∏—Ñ–∞–º
- **–ö—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –¥–æ—Ö–æ–¥—ã:** –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞ –º–µ—Å—è—Ü –¥–ª—è —Ç—Ä–µ–Ω–¥–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞

### üîß **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **BLE –º–µ—Ç—Ä–∏–∫–∏:** —Å–≤—è–∑–∞–Ω—ã —Å Bluetooth Low Energy —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é
- **MAF –º–µ—Ç—Ä–∏–∫–∏:** –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–≤–∞—Ä—Ç–∏—Ä, –∞ –Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–õ–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω—ã–µ –∫–ª—é—á–∏:** –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∫–ª—é—á–µ–π
- **–£—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏:** –∞–Ω–∞–ª–∏–∑ –ø–æ —Ç–æ—á–∫–∞–º —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏ –¥–æ–º–æ—Ñ–æ–Ω–∞–º

### ü§ñ **AI-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞:** —Ç–∞–±–ª–∏—Ü–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è AI-–∞–Ω–∞–ª–∏–∑–∞ –∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
- **–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ—Å—Ç—å:** –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ 10+ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ –µ–¥–∏–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É (–ª–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω—ã–µ –∫–ª—é—á–∏ –∏ —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ —Ç–æ—á–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –æ—Ç–∫–ª—é—á–µ–Ω—ã)
- **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏

### –ó–∞–ø—Ä–µ—â–µ–Ω–æ (ClickHouse-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)
- –ü–∏—Å–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ç—ã –≤ WHERE –≤–µ—Ä—Ö–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–ª—É—á–∏—Ç–µ ILLEGAL_AGGREGATION.
- –î–∞–≤–∞—Ç—å –∞–ª–∏–∞—Å –∞–≥—Ä–µ–≥–∞—Ç—É —Å —Ç–µ–º –∂–µ –∏–º–µ–Ω–µ–º, —á—Ç–æ –∏ –ø–æ–ª–µ —Ç–∞–±–ª–∏—Ü—ã, –∏ –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤ WHERE/SELECT (–Ω–∞–ø—Ä–∏–º–µ—Ä, `AS report_date`). –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ –∞–ª–∏–∞—Å—ã (`last_date`, `end_date`).
- –ò—Å–∫–ª—é—á–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω–∏–π —á–µ—Ä–µ–∑ –ø–æ–¥–∑–∞–ø—Ä–æ—Å —Å `arrayJoin(...)` –ø—Ä—è–º–æ –≤ WHERE. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `NOT IN ('...')` –∏–ª–∏ `NOT has([...], col)`.
