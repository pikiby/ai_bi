# def_render_chart

## Описание функции

Функция `_render_chart()` отрисовывает графики Plotly с заголовками, подписями, SQL-блоками, кодом и кнопками скачивания. Является частью рефакторинга основной функции `_render_result()`.

## Расположение в коде

**Файл:** `app.py`  
**Строки:** (будет добавлено после рефакторинга)

## Сигнатура функции

```python
def _render_chart(item: dict):
```

## Параметры

### `item: dict` - Элемент результата
- Словарь с данными графика из `st.session_state["results"]`
- Должен содержать `"kind": "chart"` и `"fig"` с объектом Plotly
- **Обязательный параметр**

## Возвращаемое значение

Функция не возвращает значения (void). Результат отображается в интерфейсе.

## Что отрисовывает

1. **Заголовок графика** - название визуализации
2. **График Plotly** - интерактивная визуализация
3. **Подпись** - объяснение графика
4. **SQL-блок** - свернутый блок с SQL-кодом
5. **Код Plotly** - свернутый блок с исходным кодом
6. **Кнопка скачивания** - HTML файл

## Алгоритм работы

1. **Проверка данных** - валидация Plotly Figure
2. **Заголовок** - получение заголовка с fallback
3. **График** - отрисовка с настройками экспорта
4. **Подпись** - объяснение или автоматическая подпись
5. **SQL** - свернутый блок с кодом
6. **Код** - свернутый блок с кодом Plotly
7. **Скачивание** - кнопка экспорта HTML

## Используемые функции

- **`_get_chart_title()`** - заголовок графика
- **`_render_chart_caption()`** - подпись графика
- **`_render_sql_block()`** - SQL блок
- **`_render_plotly_code()`** - код Plotly
- **`_render_download_buttons()`** - кнопки скачивания

## Места использования

- **`_render_result()`** - основная функция отрисовки результатов
- **Прямые вызовы** - для отображения конкретных графиков

## Обработка ошибок

- Проверка типа данных (Plotly Figure)
- Безопасная обработка отсутствующих метаданных
- Fallback на дефолтные значения

## Производительность

- Минимальные накладные расходы
- Оптимизированный рендеринг Plotly
- Ленивая загрузка кода

## Критическая важность

Эта функция является **важной** для:
- Отображения графиков в интерфейсе
- Обеспечения интерактивности
- Предоставления функциональности экспорта
- Улучшения пользовательского опыта

**Без неё графики не отображались бы в интерфейсе!**
